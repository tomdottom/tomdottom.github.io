<!doctype html>
<meta charset="utf-8">
<link rel="stylesheet" href="../static/style.css">
<link rel="stylesheet" href="../static/pygments.css">
<title> | Tom Marks</title>
<body>
  <header>
    <h1>Tom Marks</h1>
    <nav>
      <ul class="nav navbar-nav">
        <li><a href="../">Home</a></li>
        
          <li class="active"><a href="../blog/">Blog</a></li>
        
          <li><a href="../guides/">Guides</a></li>
        
          <li><a href="../about/">About</a></li>
        
      </ul>
    </nav>
  </header>
  <div class="page">
    
  
    
  <div class="blog-post">
  
    <h2><a href="../blog/testing-uwsgi/">Testing uWSGI</a></h2>
  
  <p class="meta">
    written by
    
      Tom Marks
    
    on 2017-02-21
  </p>
  <h1>The pain of testing uWSGI applications</h1>
<p>Testing uWSGI applications can be tricky becuase you can't actualy install and import uWSGI.</p>
<p>It's not very well <a href="https://github.com/unbit/uwsgi/issues/686">documented</a>, but</p>
<blockquote><p>there is no uwsgi module. It does only exist when you run the python engine from uWSGI.</p>
</blockquote>
<p>Many a developer has been fustrated by this during testing running into:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">uwsgi</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">ImportError</span><span class="p">:</span> <span class="n">No</span> <span class="n">module</span> <span class="n">named</span> <span class="n">uwsgi</span>
</pre></div>
<p>And although much of an application can be factored out into independent, and tested modules you will always have a small section that remains untested unless you engage in various levels of mocking.</p>
<h1>1. Ignore the error</h1>
<p>The easiest way to overcome the <code>ImportError</code> is just to ignore it.</p>
<div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">uwsgi</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">uwsgi</span> <span class="o">=</span> <span class="bp">None</span>
</pre></div>
<p>I've never been happy with doing this. Ignoring errors in this manner is a <a href="http://wiki.c2.com/?CodeSmell">code smell</a>!</p>
<h1>2. Mocking the uwsgi module at the system level</h1>
<p>I much prefer creating a mock uwsgi module before importing any applications under test.</p>
<p>The gist below shows how easy it really is:</p>
<p><script src="https://gist.github.com/tomdottom/afaf3a45e22dd000e9d23249dd74b0a8.js"></script></p>
<h1>3. The unrealised dream</h1>
<p>I would love to be able to do</p>
<div class="highlight"><pre><span></span>pip install mock_uwsgi
</pre></div>
<p>Then import it at the top of my test files</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mock_uwsgi</span> <span class="kn">as</span> <span class="nn">uwsgi</span>
<span class="o">...</span>
</pre></div>
<p>But this is a project for another day :(</p>

  </div>

  
    
  <div class="blog-post">
  
    <h2><a href="../blog/new-site-first-guide/">New Site &amp; First Guide</a></h2>
  
  <p class="meta">
    written by
    
      Tom Marks
    
    on 2017-02-17
  </p>
  <p>Hello &amp; Welcome,</p>
<p>This is a bit of a <a href="https://en.wikipedia.org/wiki/NOP">NOP</a> post to share my first guide
<a href="../guides/free-online-python-resources-for-beginners/">Free online Python resources for beginners</a>.</p>
<p>Hopefully this will be useful to lots of you out there. In particular members of <a href="http://www.opendatadelaware.com/">Open Data Delaware</a>.</p>
<p>I'll leave it to say that, as of writing, this site is still largely incomplete and unstyled. But I am enjoying getting to grips <a href="https://www.getlektor.com/">Lektor</a> a Python static site generator and another awesome project by <a href="https://twitter.com/mitsuhiko">Armin Ronacher</a>.</p>

  </div>

  

  
  <div class="pagination">
    
      <span class="disabled">&laquo; Previous</span>
    
    | 1 |
    
      <span class="disabled">Next &raquo;</span>
    
  </div>


  </div>
  <footer>
    &copy; Copyright 2017 by Tom Marks.
  </footer>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-92454417-1', 'auto');
    ga('send', 'pageview');

  </script>
</body>
